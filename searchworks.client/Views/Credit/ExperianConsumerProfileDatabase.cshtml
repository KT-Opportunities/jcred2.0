@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model IEnumerable<searchworks.client.Credit.PersonInformation>

@{
    ViewBag.Title = "ExperianConsumerProfile";
}

<div class="col-md-10 col-sm-10">

    <div class="col-12">
        <input type="button" value="Export PDF" onclick="Export()" class="button btn-b2" />
    </div>
    <div id="content">
        <div class="con2">

            <div class="left_col">
                <div class="results">
                    <i class='far fa-check-circle' style='font-size:30px;color:white; margin-left:10px; padding-top: 15px; display: inline-block '></i>
                    <p>2 Results</p>
                </div>
                <p class="num">@*@ViewData["ExFullname*@</p>
                <p class="num2">Experian Consumer Profile</p>

                <div class="multi non">
                    Multiple Results
                </div>
                <div class="multi act">
                    Detailed Information
                </div>

                <div class="seaInfo">
                    Search Information
                </div>

                <div class="userInfo">
                    <p class="">User:<span>@*@ViewData["user*@</span></p>
                    <p class="">Date:<span>@*@ViewData["date*@ </span></p>
                    <p class="">Reference:<span>@*@ViewData["ref*@</span></p>
                    <p class="">Request:<br /><span>@*@ViewData["ResponseMessage*@</span></p>
                </div>
            </div>
            <div class="right_col">
                <div id="notification" class="seaRes">
                    NCR NOTIFICATION <span id="plusNot" class="coll"><i class="fas fa-plus"></i></span><span id="minusNot" class="coll"><i class="fas fa-minus"></i></span>
                </div>
                <div class="not">
                    Please note that the search results will automatically be deleted with in 72hours as per NCR regulations.
                    We recommend downloading/exporting a PDF or EXCEL copy of this search and storing it locally.<br>
                    <!--                                Click on In the top <p class="expt"></p> in the top left corner to download/export this search.-->
                </div>

                <div id="notification" class="seaRes">
                    Experian <span id="plusPerInfo" class="coll"><i class="fas fa-plus"></i></span><span id="minusPerInfo" class="coll"><i class="fas fa-minus"></i></span>
                </div>

                <div class="PerInfo">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th id="PIU" style="border: none; cursor:pointer;" colspan="2">Person Information</th>
                            </tr>
                        </thead>
                        <tbody id="PITU" style="display:none;">
                            @foreach (var p in ViewBag.PersonInfoList)
                            {
                                <tr>
                                    <td colspan="2">Title</td>
                                    <td style="border: none;" colspan="4">@p.Title</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Date of Birth</td>
                                    <td style="border: none;" colspan="4">@p.DateOfBirth</td>
                                </tr>
                                <tr>
                                    <td colspan="2">First Name</td>
                                    <td style="border: none;" colspan="4">@p.FirstName</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Middle Name</td>
                                    <td style="border: none;" colspan="4">@p.MiddleName1</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Surname</td>
                                    <td style="border: none;" colspan="4">@p.Surname</td>
                                </tr>
                                <tr>
                                    <td colspan="2">FullName</td>
                                    <td style="border: none;" colspan="4">@p.Fullname</td>
                                </tr>
                                <tr>
                                    <td colspan="2">ID Number</td>
                                    <td style="border: none;" colspan="4">@p.IDNumber</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Gender</td>
                                    <td style="border: none;" colspan="4">@p.Gender</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Age</td>
                                    <td style="border: none;" colspan="4">@p.Age</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Marital Status</td>
                                    <td style="border: none;" colspan="4">@p.MaritalStatus</td>
                                </tr>

                                <tr>
                                    <td colspan="2">Reference</td>
                                    <td style="border: none;" colspan="4">@p.Reference</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Has Properties</td>
                                    <td style="border: none;" colspan="4">@p.HasProperties</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="PerInfo">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th id="HAIU" style="border: none; cursor:pointer;" colspan="2">Home Affairs Information</th>
                            </tr>
                        </thead>
                        <tbody id="HAITU" style="display:none;">
                            @foreach (var hm in ViewBag.HomeAffairsInfoList)
                            {
                                <tr>
                                    <td colspan="2">ID Verified</td>
                                    <td style="border: none;" colspan="4">@hm.IDVerified</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Surname Verified</td>
                                    <td style="border: none;" colspan="4">@hm.SurnameVerified</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Initials Verified</td>
                                    <td style="border: none;" colspan="4">
                                        @hm.InitialsVerified
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="PerInfo">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th id="CONI" style="border: none; cursor:pointer;" colspan="2">Contact Information</th>
                            </tr>
                        </thead>
                        <tbody id="CONIT" style="display:none;">
                            @if (ViewBag.contactInformationListCount != 0)
                            {
                                foreach (var item in ViewBag.contactInformationList)
                                {
                                    <tr>
                                        <td colspan="2">Physical Address</td>
                                        <td style="border: none;" colspan="4">@item.PhysicalAddress</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="7">No Data</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="PerInfo">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th id="CI" style="border: none; cursor:pointer;" colspan="2">Credit Information</th>
                            </tr>
                        </thead>
                        <tbody id="CIT" style="display:none;">
                            @if (ViewBag.creditInformationList != null)
                            {
                                foreach (var item in ViewBag.creditInformationList)

                                {
                                    <tr>
                                        <td colspan="2">DelphiScore</td>
                                        <td style="border: none;" colspan="5">@item.DelphiScore</td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">Flag Count</td>
                                        <td style="border: none;" colspan="5">@item.FlagCount</td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">Flag Details</td>
                                        <td style="border: none;" colspan="5">@item.FlagDetails</td>
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="7">No Data</td>
                                </tr>
                            }

                            <tr>
                                <th colspan="7" class="col_header">Data Counts</th>
                            </tr>
                            @foreach (var item in ViewBag.dataCountsList)
                            {
                                <tr>
                                    <td colspan="2">Accounts</td>
                                    <td colspan="5" style="border: none;">@item.Accounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Enquires</td>
                                    <td colspan="5" style="border: none;">@item.Enquires</td>
                                </tr>
                                @*<tr>
                                    <td colspan="2">Judgments</td>
                                    <td colspan="5" style="border: none;">@item.Judgments</td>
                                    </tr>
                                *@
                                <tr>
                                    <td colspan="2">Notices</td>
                                    <td colspan="5" style="border: none;">@item.Notices</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Bank Defaults</td>
                                    <td colspan="5" style="border: none;">@item.BankDefaults</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Defaults</td>
                                    <td colspan="5" style="border: none;">@item.Defaults</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Collections</td>
                                    <td colspan="5" style="border: none;">@item.Collections</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Directors</td>
                                    <td colspan="5" style="border: none;">@item.Directors</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Address</td>
                                    <td colspan="5" style="border: none;">@item.Addresses</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Telephones</td>
                                    <td colspan="5" style="border: none;">@item.Telephones</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Occupants</td>
                                    <td colspan="5" style="border: none;">@item.Occupants</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Employers</td>
                                    <td colspan="5" style="border: none;">@item.Employers</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Trace Alerts</td>
                                    <td colspan="5" style="border: none;">@item.TraceAlerts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Payment Profiles</td>
                                    <td colspan="5" style="border: none;">@item.PaymentProfiles</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Own Enquires</td>
                                    <td colspan="5" style="border: none;">@item.OwnEnquiries</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Admin Orders</td>
                                    <td colspan="5" style="border: none;">@item.AdminOrders</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Possible Matches</td>
                                    <td colspan="5" style="border: none;">@item.PossibleMatches</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Definite Matches</td>
                                    <td colspan="5" style="border: none;">@item.DefiniteMatches</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Loans</td>
                                    <td colspan="5" style="border: none;">@item.Loans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Fraud Alerts</td>
                                    <td colspan="5" style="border: none;">@item.FraudAlerts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Companies</td>
                                    <td colspan="5" style="border: none;">@item.Companies</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Properties</td>
                                    <td colspan="5" style="border: none;">@item.Properties</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Documents</td>
                                    <td colspan="5" style="border: none;">@item.Documents</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Demand Letters</td>
                                    <td colspan="5" style="border: none;">@item.DemandLetters</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Trusts</td>
                                    <td colspan="5" style="border: none;">@item.Trusts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Bonds</td>
                                    <td colspan="5" style="border: none;">@item.Bonds</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Deeds</td>
                                    <td colspan="5" style="border: none;">@item.Deeds</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Public Defaults</td>
                                    <td colspan="5" style="border: none;">@item.PublicDefaults</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR Accounts</td>
                                    <td colspan="5" style="border: none;">@item.NLRAccounts</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">Debt Review Status</th>
                            </tr>
                            @foreach (var Debt in ViewBag.debtReviewStatusList)
                            {
                                <tr>
                                    <td colspan="2">Status Code</td>
                                    <td colspan="5" style="border: none;">@Debt.StatusCode</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Status Description</td>
                                    <td colspan="5" style="border: none;">@Debt.StatusDescription</td>
                                </tr>

                            }
                            <tr>
                                <th colspan="7" class="col_header">Consumer Statistics</th>
                            </tr>
                            @foreach (var item in ViewBag.consumerstatsList)
                            {

                                <tr>
                                    <td colspan="2">Highest Judgment</td>
                                    <td colspan="5">@item.HighestJudgment</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Revolving Accounts</td>
                                    <td colspan="5">@item.RevolvingAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Instalment Accounts</td>
                                    <td colspan="5">@item.InstalmentAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Open Accounts</td>
                                    <td colspan="5">@item.OpenAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Adverse Accounts</td>
                                    <td colspan="5">@item.AdverseAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Percent Arrears</td>
                                    <td colspan="5">@item.Percent0ArrearsLast12Histories</td>
                                </tr>
                                <tr>
                                    <td colspan="2">PPS Last 12 Months</td>
                                    <td colspan="5">@item.NumberPPSLast12Months</td>
                                </tr>
                                @*<tr>
                                    <td colspan="2">Micro loans Past 12 Months</td>
                                    <td colspan="5">@item.MicroloansPast12Months</td>
                                    </tr>*@
                            }
                            <tr>
                                <th colspan="7" class="col_header">NLR Stats</th>
                            </tr>
                            @foreach (var item in ViewBag.nlrstatsList)
                            {
                                <tr>
                                    <td colspan="2">Active Accounts</td>
                                    <td colspan="5">@item.ActiveAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Closed Accounts</td>
                                    <td colspan="5">@item.ClosedAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Worst Month Arrears</td>
                                    <td colspan="5">@item.WorstMonthArrears</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Worst Month Arrears Status</td>
                                    <td colspan="5">@item.WorstArrearsStatus</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Balance Exposure</td>
                                    <td colspan="5">@item.BalanceExposure</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Cumulative Arrears</td>
                                    <td colspan="5">@item.CumulativeArrears</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">CCA Stats</th>
                            </tr>
                            @foreach (var item in ViewBag.ccastatsList)
                            {
                                <tr>
                                    <td colspan="2">Active Accounts</td>
                                    <td colspan="5">@item.ActiveAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Closed Accounts</td>
                                    <td colspan="5">@item.ClosedAccounts</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Worst Month Arrears</td>
                                    <td colspan="5">@item.WorstMonthArrears</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Balance Exposure</td>
                                    <td colspan="5">@item.BalanceExposure</td>
                                </tr>
                                <tr>
                                    <td colspan="2">Cumulative Arrears</td>
                                    <td colspan="5">@item.CumulativeArrears</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">NLR 12 Months</th>
                            </tr>

                            @foreach (var item in ViewBag.nlr12monthsList)
                            {

                                <tr>
                                    <td colspan="2">NLR12Months Enquiries By Client:</td>
                                    <td colspan="5">@item.EnquiriesByClient</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR12Months Enquiries By Other:</td>
                                    <td colspan="5">@item.EnquiriesByOther</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR12Months Positive Loans:</td>
                                    <td colspan="5">@item.PositiveLoans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR12Months Highest Months In Arrears: </td>
                                    <td colspan="5">@item.HighestMonthsInArrears</td>
                                </tr>

                            }
                            <tr>
                                <th colspan="7" class="col_header">NLR 24 Months</th>
                            </tr>
                            @foreach (var item in ViewBag.nlr24monthsList)
                            {

                                <tr>
                                    <td colspan="2">NLR24Months Enquiries By Client:</td>
                                    <td colspan="5">@item.EnquiriesByClient</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR24Months Enquiries By Other:</td>
                                    <td colspan="5">@item.EnquiriesByOther</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR24Months Positive Loans:</td>
                                    <td colspan="5">@item.PositiveLoans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR24Months Highest Months In Arrears:</td>
                                    <td colspan="5">@item.HighestMonthsInArrears</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">NLR 36 Months</th>
                            </tr>
                            @foreach (var item in ViewBag.nlr36monthsList)
                            {

                                <tr>
                                    <td colspan="2">NLR36Months Enquiries By Client:</td>
                                    <td colspan="5">@item.EnquiriesByClient</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR36Months Enquiries By Other:</td>
                                    <td colspan="5">@item.EnquiriesByOther</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR36Months Positive Loans:</td>
                                    <td colspan="5">@item.PositiveLoans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">NLR36Months Highest Months In Arrears:</td>
                                    <td colspan="5">@item.HighestMonthsInArrears</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">CCA 12 Months</th>
                            </tr>
                            @foreach (var item in ViewBag.cca12monthsList)
                            {

                                <tr>
                                    <td colspan="2">CCA12Months Enquiries By Client:</td>
                                    <td colspan="5">@item.EnquiriesByClient</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA12Months Enquiries By Other:</td>
                                    <td colspan="5">@item.EnquiriesByOther</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA12Months Positive Loans:</td>
                                    <td colspan="5">@item.PositiveLoans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA12Months Highest Months In Arrears:</td>
                                    <td colspan="5">@item.HighestMonthsInArrears</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">CCA 24 Months</th>
                            </tr>
                            @foreach (var item in ViewBag.cca24monthsList)
                            {
                                <tr>
                                    <td colspan="2">CCA24Months Enquiries By Client:</td>
                                    <td colspan="5">@item.EnquiriesByClient</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA24Months Enquiries By Other:</td>
                                    <td colspan="5">@item.EnquiriesByOther</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA24Months Positive Loans:</td>
                                    <td colspan="5">@item.PositiveLoans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA24Months Highest Months In Arrears:</td>
                                    <td colspan="5">@item.HighestMonthsInArrears</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="7" class="col_header">CCA 36 Months</th>
                            </tr>
                            @foreach (var item in ViewBag.cca36monthsList)
                            {
                                <tr>
                                    <td colspan="2">CCA36Months Enquiries By Client:</td>
                                    <td colspan="5">@item.EnquiriesByClient</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA36Months Enquiries By Other:</td>
                                    <td colspan="5">@item.EnquiriesByOther</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA36Months Positive Loans:</td>
                                    <td colspan="5">@item.PositiveLoans</td>
                                </tr>
                                <tr>
                                    <td colspan="2">CCA36Months Highest Months In Arrears:</td>
                                    <td colspan="5">@item.HighestMonthsInArrears</td>
                                </tr>
                            }

                            <tr>
                                <th colspan="7" class="col_header">Enquiry History</th>
                            </tr>
                            <tr>
                                <th colspan="2">Date</th>
                                <th colspan="4">By</th>
                                <th>Contact</th>
                            </tr>
                            @foreach (var item in @ViewBag.enquiryInformationList)
                            {

                                <tr>
                                    <td colspan="2">@item.EnquiryDate</td>
                                    <td colspan="4">@item.EnquiredBy</td>
                                    <td>@item.EnquiredByContact</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="PerInfo">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th id="HI" style="border: none; cursor:pointer;" colspan="2">Historical Information</th>
                            </tr>
                        </thead>
                        <tbody id="HIT" style="display:none;">
                            <tr>
                                <th colspan="8" class="col_header">Address History</th>
                            </tr>
                            @if (@ViewBag.addressInformationListCount != 0)
                            {

                                <tr>
                                    <th colspan="2">TypeDescription</th>
                                    <th colspan="1">Line1</th>
                                    <th colspan="1">Line2</th>
                                    <th colspan="1">Line3</th>
                                    <th colspan="1">PostalCode</th>
                                    <th colspan="1">FullAddress</th>
                                    <th colspan="1">LastUpdated</th>
                                </tr>
                                foreach (var item in @ViewBag.addressInformationList)
                                {

                                    <tr>
                                        <td colspan="2">@item.TypeDescription</td>
                                        <td colspan="1">@item.Line1</td>
                                        <td colspan="1">@item.Line2</td>
                                        <td colspan="1">@item.Line3</td>
                                        <td colspan="1">@item.PostalCode</td>
                                        <td colspan="1">@item.FullAddress</td>
                                        <td colspan="1">@item.LastUpdatedDate</td>
                                    </tr>
                                }

                            }
                            else
                            {
                                <tr>

                                    <td colspan="8">No Data</td>
                                </tr>
                            }

                            <tr>
                                <th colspan="8" class="col_header">Telephone History</th>
                            </tr>

                            @if (@ViewBag.telephoneInformationListCount != 0)
                            {
                                <tr>
                                    <th colspan="2">TypeDescription</th>
                                    <th colspan="1">DialCode</th>
                                    <th colspan="1">Number</th>
                                    <th colspan="1">FullNumber</th>
                                    <th colspan="3">LastUpdatedDateTel</th>
                                </tr>

                                foreach (var item in @ViewBag.telephoneInformationList)
                                {
                                    <tr>
                                        <td colspan="2">@item.TypeDescriptionTel</td>
                                        <td colspan="1">@item.DialCode</td>
                                        <td colspan="1">@item.Number</td>
                                        <td colspan="1">@item.FullNumber</td>
                                        <td colspan="3">@item.LastUpdatedDateTel</td>
                                    </tr>
                                }

                            }
                            else
                            {
                                <tr>

                                    <td colspan="8">No Data</td>
                                </tr>
                            }
                            <tr>
                                <th colspan="8" class="col_header">Employment History</th>
                            </tr>

                            @if (@ViewBag.employmentInformationListCount != 0)
                            {
                                <tr>
                                    <th colspan="4">EmployerName</th>
                                    <th colspan="4">Designation</th>
                                </tr>
                                <tr>
                                    @ViewData["employmentInformationListCount"].ToString()
                                </tr>
                                foreach (var item in @ViewBag.employmentInformationList)
                                {
                                    <tr>
                                        <td colspan="4">@item.EmployerName</td>
                                        <td colspan="4">@item.Designation</td>
                                    </tr>
                                }

                            }
                            else
                            {
                                <tr>

                                    <td colspan="8">No Data</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>